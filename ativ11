alter table ENSINA
add CODDISCIPLINA varchar(20) 
references DISCIPLINA (CODDISCIPLINA)

SELECT MATRICULA AS matr_professor,
		TURMA.CODTURMA,
		TURMA.CODDISCIPLINA
		INTO TEMP_PROFESSOR_CODTURMA_CODDISCIPLINA
FROM ENSINA
INNER JOIN TURMA ON ENSINA.CODTURMA = TURMA.CODTURMA
ORDER BY MATRICULA, CODDISCIPLINA


update ensina 
set CODDISCIPLINA = (select CODDISCIPLINA from TEMP_PROFESSOR_CODTURMA_CODDISCIPLINA t where t.matr_professor = ENSINA.MATRICULA and t.CODTURMA = ENSINA.CODTURMA)

alter table FREQUENTA
add CODDISCIPLINA varchar(20) 
references DISCIPLINA (CODDISCIPLINA)

SELECT MATRICULA AS matricula_aluno,
		TURMA.CODTURMA,
		TURMA.CODDISCIPLINA
		INTO TEMPoraria2
FROM FREQUENTA
INNER JOIN TURMA ON FREQUENTA.CODTURMA = TURMA.CODTURMA
ORDER BY MATRICULA, CODDISCIPLINA

update FREQUENTA
set CODDISCIPLINA = (select CODDISCIPLINA from TEMPoraria2 t where t.matricula_aluno = FREQUENTA.MATRICULA and t.CODTURMA = FREQUENTA.CODTURMA)
